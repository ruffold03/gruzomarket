<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤ - –ê–≤—Ç–æ–∑–∞–ø—á–∞—Å—Ç–∏</title>
    <link rel="stylesheet" th:href="@{/css/style.css}" href="/css/style.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-container">
            <a href="/" class="logo">üöó AutoParts</a>
            <div class="search-bar">
                <span class="search-icon">üîç</span>
                <input type="text" id="searchInput" th:value="${searchTerm ?: ''}" placeholder="–ü–æ–∏—Å–∫ –∑–∞–ø—á–∞—Å—Ç–µ–π...">
            </div>
            <div class="header-actions">
                <a href="/cart" class="cart-icon">
                    üõí
                    <span class="cart-badge" style="display: none;">0</span>
                </a>
                <a href="/login" class="btn btn-secondary">–í–æ–π—Ç–∏</a>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="nav">
        <div class="nav-container">
            <ul class="nav-list">
                <li class="nav-item"><a href="/" class="nav-link">–ì–ª–∞–≤–Ω–∞—è</a></li>
                <li class="nav-item"><a href="/products" class="nav-link active">–ö–∞—Ç–∞–ª–æ–≥</a></li>
                <li class="nav-item"><a href="/categories" class="nav-link">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>
                <li class="nav-item"><a href="/about" class="nav-link">–û –Ω–∞—Å</a></li>
                <li class="nav-item"><a href="/contact" class="nav-link">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-container">
        <div class="products-section">
            <!-- Filters Sidebar -->
            <aside class="filters-sidebar">
                <h3 class="filters-title">–§–∏–ª—å—Ç—Ä—ã</h3>
                
                <!-- Category Filter -->
                <div class="filter-group">
                    <label class="filter-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</label>
                    <div class="checkbox-group" id="categoryFilter">
                        <div class="checkbox-item" th:each="category : ${allCategories}">
                            <input type="checkbox" th:id="'cat_' + ${category.id}" th:value="${category.id}" 
                                   th:checked="${selectedCategories != null && selectedCategories.contains(category.id)}">
                            <label th:for="'cat_' + ${category.id}" th:text="${category.name}">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        </div>
                    </div>
                </div>

                <!-- Brand Filter -->
                <div class="filter-group">
                    <label class="filter-label">–ë—Ä–µ–Ω–¥—ã</label>
                    <div class="checkbox-group" id="brandFilter">
                        <div class="checkbox-item" th:each="brand : ${allBrands}">
                            <input type="checkbox" th:id="'brand_' + ${brand.id}" th:value="${brand.id}"
                                   th:checked="${selectedBrands != null && selectedBrands.contains(brand.id)}">
                            <label th:for="'brand_' + ${brand.id}" th:text="${brand.name}">–ë—Ä–µ–Ω–¥</label>
                        </div>
                    </div>
                </div>

                <!-- Price Range -->
                <div class="filter-group">
                    <label class="filter-label">–¶–µ–Ω–∞</label>
                    <div class="price-range">
                        <input type="number" id="minPrice" class="price-input" placeholder="–û—Ç" th:value="${minPrice}">
                        <span>-</span>
                        <input type="number" id="maxPrice" class="price-input" placeholder="–î–æ" th:value="${maxPrice}">
                    </div>
                </div>

                <!-- Stock Filter -->
                <div class="filter-group">
                    <label class="filter-label">–ù–∞–ª–∏—á–∏–µ</label>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="inStock" th:checked="${inStock != null && inStock}">
                            <label for="inStock">–í –Ω–∞–ª–∏—á–∏–∏</label>
                        </div>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="applyFilters()" style="width: 100%; margin-top: 1rem;">–ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã</button>
            </aside>

            <!-- Products -->
            <div>
                <div class="products-header">
                    <div>
                        <h2 class="products-title">–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤</h2>
                        <span class="products-count" th:text="'–ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ' + ${products.size()}">–ù–∞–π–¥–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: 0</span>
                    </div>
                    <select id="sortSelect" class="sort-select" onchange="applyFilters()">
                        <option value="name_asc" th:selected="${sort == 'name_asc'}">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–ê-–Ø)</option>
                        <option value="name_desc" th:selected="${sort == 'name_desc'}">–ü–æ –Ω–∞–∑–≤–∞–Ω–∏—é (–Ø-–ê)</option>
                        <option value="price_asc" th:selected="${sort == 'price_asc'}">–ü–æ —Ü–µ–Ω–µ (–≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–µ)</option>
                        <option value="price_desc" th:selected="${sort == 'price_desc'}">–ü–æ —Ü–µ–Ω–µ (—É–±—ã–≤–∞–Ω–∏–µ)</option>
                    </select>
                </div>

                <div class="products-grid" th:if="${!products.isEmpty()}">
                    <div class="product-card" th:each="product : ${products}">
                        <div class="product-image">üîß</div>
                        <div class="product-info">
                            <div class="product-category" th:text="${categoryMap[product.categoryId] ?: '–ó–∞–ø—á–∞—Å—Ç–∏'}">–ó–∞–ø—á–∞—Å—Ç–∏</div>
                            <div class="product-name" th:text="${product.name}">–ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</div>
                            <div class="product-article" th:text="'–ê—Ä—Ç–∏–∫—É–ª: ' + ${product.article}">–ê—Ä—Ç–∏–∫—É–ª: 12345</div>
                            <div class="product-price" th:text="${#numbers.formatDecimal(product.price, 0, 'COMMA', 2, 'POINT')} + ' ‚ÇΩ'">5000 ‚ÇΩ</div>
                            <div class="product-stock" th:classappend="${product.quantity > 10 ? 'stock-available' : (product.quantity > 0 ? 'stock-low' : 'stock-unavailable')}"
                                 th:text="${product.quantity > 10 ? '–í –Ω–∞–ª–∏—á–∏–∏' : (product.quantity > 0 ? '–ú–∞–ª–æ –≤ –Ω–∞–ª–∏—á–∏–∏ (' + ${product.quantity} + ')' : '–ù–µ—Ç –≤ –Ω–∞–ª–∏—á–∏–∏')}">–í –Ω–∞–ª–∏—á–∏–∏</div>
                            <div class="product-actions">
                                <button class="btn-add-cart" th:onclick="'addToCart(' + ${product.id} + ')'" 
                                        th:disabled="${product.quantity == 0}">–í –∫–æ—Ä–∑–∏–Ω—É</button>
                                <button class="btn-favorite">‚ù§Ô∏è</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div th:if="${products.isEmpty()}" style="text-align: center; padding: 3rem;">
                    <p style="font-size: 1.25rem; color: var(--text-color);">–¢–æ–≤–∞—Ä—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
                    <p style="color: #6b7280; margin-top: 0.5rem;">–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ –∏–ª–∏ —Ñ–∏–ª—å—Ç—Ä—ã</p>
                </div>

                <!-- Pagination -->
                <div class="pagination" th:if="${totalPages > 1}">
                    <button class="pagination-btn" th:onclick="'window.location.href=\'?page=' + (${currentPage} - 1) + '\''" 
                            th:disabled="${currentPage == 0}">–ù–∞–∑–∞–¥</button>
                    <span th:each="page : ${#numbers.sequence(0, totalPages - 1)}">
                        <button class="pagination-btn" th:classappend="${page == currentPage ? 'active' : ''}"
                                th:onclick="'window.location.href=\'?page=' + ${page} + '\''" th:text="${page + 1}">1</button>
                    </span>
                    <button class="pagination-btn" th:onclick="'window.location.href=\'?page=' + (${currentPage} + 1) + '\''"
                            th:disabled="${currentPage == totalPages - 1}">–í–ø–µ—Ä–µ–¥</button>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section">
                <h3>–û –∫–æ–º–ø–∞–Ω–∏–∏</h3>
                <ul>
                    <li><a href="/about">–û –Ω–∞—Å</a></li>
                    <li><a href="/contact">–ö–æ–Ω—Ç–∞–∫—Ç—ã</a></li>
                    <li><a href="/delivery">–î–æ—Å—Ç–∞–≤–∫–∞</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>–ö–∞—Ç–∞–ª–æ–≥</h3>
                <ul>
                    <li><a href="/products">–í—Å–µ —Ç–æ–≤–∞—Ä—ã</a></li>
                    <li><a href="/categories">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>
                    <li><a href="/brands">–ë—Ä–µ–Ω–¥—ã</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>–ü–æ–º–æ—â—å</h3>
                <ul>
                    <li><a href="/faq">FAQ</a></li>
                    <li><a href="/returns">–í–æ–∑–≤—Ä–∞—Ç</a></li>
                    <li><a href="/warranty">–ì–∞—Ä–∞–Ω—Ç–∏—è</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h3>–ö–æ–Ω—Ç–∞–∫—Ç—ã</h3>
                <ul>
                    <li>–¢–µ–ª–µ—Ñ–æ–Ω: +7 (999) 123-45-67</li>
                    <li>Email: info@autoparts.ru</li>
                    <li>–ê–¥—Ä–µ—Å: –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, 1</li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2024 AutoParts. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
        </div>
    </footer>

    <script th:src="@{/js/main.js}" src="/js/main.js"></script>
</body>
</html>

